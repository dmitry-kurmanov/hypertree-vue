{"version":3,"sources":["..\\node_modules\\hyperapp\\src\\index.js","..\\src\\components\\TreeNode.js","..\\src\\actions.js","..\\src\\index.js"],"names":["h","app","name","attributes","rest","children","length","arguments","push","node","pop","nodeName","key","state","actions","view","container","map","rootElement","oldNode","recycleElement","lifecycle","skipRender","isRecycling","globalState","clone","wiredActions","wireStateToActions","scheduleRender","element","toLowerCase","call","childNodes","nodeType","nodeValue","resolveNode","render","patch","setTimeout","target","source","out","i","set","path","value","slice","get","action","data","result","then","concat","getKey","eventListener","event","currentTarget","events","type","updateAttribute","oldValue","isSvg","style","setProperty","addEventListener","removeEventListener","setAttribute","removeAttribute","createElement","document","createTextNode","createElementNS","oncreate","appendChild","updateElement","oldAttributes","cb","onupdate","removeChildren","ondestroy","removeElement","parent","done","removeChild","onremove","newElement","insertBefore","oldKeyed","newKeyed","oldElements","oldChildren","oldKey","k","newKey","keyedNode","TreeNode","config","callAction","clickHandler","childrenIds","id","stopPropagation","marginLeft","display","isExpand","renderHeader","text","console","log","getState","subscribe","subscribeHandler","handler","changeTitle","title","toggleExpandCollapse","nodes","normalize","nodesCount","stack","normalizedTree","addNodeToSiblings","forEach","siblingNode","siblingIndex","Array","isArray","siblingsIds","index","parentId","shift","subnode","generateMarkup","markup","nodeMarkup","nodeConfig","childConfig","childMarkup","nodeId","childId","actionName","payload","warn","newState","doCallAction","actionHandlers","body"],"mappings":";;;;;;QAAgBA,IAAAA;QA4BAC,MAAAA;AA5BT,SAASD,CAAT,CAAWE,IAAX,EAAiBC,UAAjB,EAA6B;AAClC,MAAIC,OAAO,EAAX;AACA,ACFF,MDEMC,WAAW,EAAf;AACA,MAAIC,SAASC,UAAUD,MAAvB;ACDK,IAAMyF,8BAAW,SAAXA,QAAW,OAAyB1F,QAAzB,EAAsC;ADG5D,ACH4D,MAAnC2F,GDGlB1F,GCHqD,QDG1C,ACHO0F,CDGzB,EAAqB5F,GCHuC,EDGlCI,IAAL,CAAUD,UAAUD,MAAV,CAAV;ACHuC,MAA3B2F,UAA2B,QAA3BA,UAA2B;ADK5D,AEPK,IAAMnF,KFOJV,KAAKE,MAAZ,EAAoB,UEPC;AFQnB,AEPFuG,ADEA,AEHF,MFGQX,EDKAzF,IEPI,GFOGL,KAAKM,CCLG,EDKR,EAAX,KCLIwF,YAAe,QAAS;ADM5B,AERQ,ADGR,QDKIzF,ACLAuF,GCHU,IDGHG,CDKC1F,KAAKC,GAAjB,EAAsB,ACLlB,CAAmBJ,CCHA,KDGnB,KAA8B,CAAlC,EACE2F,WAAW,sBAAX,EAAmCD,OAAOI,EAA1C;ADKA,AERF,ADIA7C,AEJJ,UFIU8C,CDIC/F,EERAO,KAAP,EFQgBJ,KAAKH,ACJrB,MDIE,EAA2BA,QAA3B,GAAuC;AACrCF,AERL,ADIA,GAJD,ECFU,QFUCI,IAAL,CAAUC,KAAKH,MAAL,CAAV;AACD,AEXK,ACEZ,GDHuB;AFalB,ACJH,KDAE,CCAIwD,KDIG,GCJK,CDIDrD,QAAQ,IAAR,IAAgBA,SAAS,IAAzB,IAAiCA,SAAS,KAA9C,EAAqD;AAC1DJ,AETJyG,ADKER,AELG,IAAMe,SDAA,EFSE7G,CCJC,GDIV,CAAcC,ECLJ,EDKV,YGTmB,SAAZ4G,SAAY,CAACD,KAAD,EAAQE,UAAR,EAAuB;AHU3C,AEVQ,ADMTf,AELF,MAAIH,KDDkB,EDMXJ,IELX,GFKkBQ,QCNa,ADMpB,GAAkB,OAAlB,GAA4B;ADKtC,AEVC,ADGY,AEHd,GFGA,GEHQ/F,aAAR,ODAcI,KAAZ,IAAmBkG,kBAAkBC,OAArC;AACD,ACAD,KDFW,CCEPO,QAAQH,KAAZ;AHWA,AEbW,ADSX,AENA,GDRqB,GDcfX,AENFe,GHUG,OAAOtH,IAAP,CCJc,EENA,EHUE,AGVvB,KFMMuG,KDIC,GACHvG,ICLiB,CDKZC,ECLkB,YDKJ,EAAnB,EAAuBE,QAAvB,CADG,GAEH;AACEM,ACNJ,QAAIqF,MDMU9F,CCNHiG,GDKT,QCLE,CAAmB7F,MAAnB,KAA8B,CAAlC,EAAqC,OAAO;ADOxCH,AEbN8G,ADM8C,AEL9C,MAAMQ,SDDO,CFaKtH,UGZQ,IHYM,EAF5B,GGVEsH,iBAAoB,CAAChH,IAAD,EAAO2G,KAAP,EAAiB;AHarC/G,AEdO,ADMiC,AEJ5C+G,UAAMM,CDFc,GFcNrH,GGZd,CAAc,IHSZ,MEX2B,ACEdsH,WAAD,EAAcC,YAAd,EAA+B;AHazChH,AEdJ,ADKiDoF,AEH/C,SHYO7F,CGZH,CAAC0H,EFGiDnB,IEH3CoB,MHYU3H,CGZhB,CAAcwH,CDFT9G,KAAZ,GFckCD,CEdfsG,ECEca,KDFPb,KAA1B,CCEO,CAAL,EAA6CS,YAAYI,WAAZ,GAA0B,EAA1B;AHQ7C,AETH,ADI6C,AEF1C,GHKJ,EETa,ADM0B,KEF/BH,iBAAiBnH,KAAKuH,KAAL,GAAa,CAAlC,EAAqC;AHa1C,AEjBc,ADOX,AEFEL,GDdiB,KDgBf3B,OAAOQ,GEFGuB,KFEd,EAAqB,IEFnB,CAAwBvH,EFEE,EEF1B,CAA6BC,KAAK2F,EAAlC;AFE0B,AED3B,KAJD;AHiBG,AEfLe,ADG8B,AEA7B,GAND,MHkBclH,GAAT,CAAaY,KAAb,EAAoBC,IEfH,GFejB,EAA6BC,IAA7B,EAAmCC,SAAnC,EAA8C;AACnD,AEhBsB,ADGQ,MDa1BC,KEhBwB,CFgBlB,GAAGA,GAAb,GEhB6BJ,KAAD,EAAQC,OAAR,EAAoB;AFiBhD,AEhBE,ADEmCkF,AEErCuB,MHYIrG,EGZEwG,EDJEjH,GDEoCiG,EEE5C,CAAc,CDJC7F,GFgBIG,GEhBEoG,GCIN3G,EDJA,CAAY2F,CCIb,CDJC,CAAb,ACImB4B,CHYWhH,IGZlB,EAAiB,IHYWX,QAAV,CAAmB,CAAnB,CAAd,IAAwC,IAA1D;AACA,AEhBE,ADC4B,AEG5BI,KFHqB,CDenBU,GGZG8G,CDJCzB,MFgBMtF,CGZZ,GAAgB,CDJC,CAACT,ICIlB,CDJuB+F,IFgBIpF,IEhB3B,WFgB0CF,WAAf,CAA7B;AACA,AEhBE,ADCA,AEGAT,MHYEY,GGZG2G,EFHE,GEGP,GAAaA,CHYC,EAAhB,KGZuB,CDHhBnH,ACGL,KDJA;AFiBF,AEfIuG,ADDK,AEIP3G,MHYEa,GGZG8E,EAAL,GAAU,EHYZ,WGZyBkB,CDFhBzG,MAAMuG,KADX,ACGF,sBDDKhB,EAFH,eAGO3F,IAHP;AFgBJ,AEZQ+F,ADLC,AEKPiB,MHYElG,cAAc,EGZEd,EHYpB,EGZE,EAAwB8G,KAAxB;AHaF,AEjBI,ADDK,AEMR,GALD,GHiBI/F,cAAcC,MAAMZ,KAAN,CAAlB;AACA,AEpBE,ADCcmF,MDmBZtE,OCnBmBgF,QDmBJ/E,mBAAmB,EAAnB,EAAuBH,WAAvB,EAAoCC,MAAMX,OAAN,CAApC,CAAnB;AEVC,ADTQ,AEQT,KDZsB,ADIpB,IEQKyG,MAAMjH,MAAN,GAAe,CAAtB,EAAyB;AHazBsB,AEzBsB,ADKrB,AEQCnB,GFZF,QEYS8G,MAAMW,KAAN,EAAP;AD1BmB,AC2BnB9B,CD3BG,QC2BE3F,KAAK2F,EAAV;AHaF,ACpBA,SDoBO1E,ACnBL,YDmBF;ACnBE,AEQA;AHaF,ACrBE,AESA,QAAI,GHYGN,KGZIX,KAAK+F,IHYlB,CAAwB3E,GGZlB,IHYN,EAAiC,QGZK,IAAhC,CAAJ,EAA0CpB,KAAK+F,QAAL,GAAgB,IAAhB;AHa1C,ACrBE,AESF,WHYO,KCrBK;ADsBV7F,ACtBU,eAAMgG,CDsBN9E,OCtBc+E,CDsBNjG,ECtBF,CAAY,KDsBlB,CAAiBmB,SCtBX,CAAN,CDsBA,EADL;AAEL3B,ACvBU,AEWZ,OFZA,CEYI0H,MAAMC,IHYI,EAFP,CGVH,CAAcrH,KAAKJ,QAAnB,CAAJ,EAAkC;AHahCA,ACvBA,AEWAI,WAAKJ,KHYKY,ACvBA,GEWV,CHYcc,AGZA2F,IHYJ,CAAS7F,EGZnB,CAAsB,KHYKG,KGZJmG,KHYb,EAA6B,AGZjB,EAAUH,KAAV,EAAoB,CHYMnG,OAAT,EAAkB;AACvD,ACxBQ,AEYRsG,eHYOtG,ACxBO8E,CEYN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","file":"src.4291c85e.map","sourceRoot":"..\\example","sourcesContent":["export function h(name, attributes) {\n  var rest = []\n  var children = []\n  var length = arguments.length\n\n  while (length-- > 2) rest.push(arguments[length])\n\n  while (rest.length) {\n    var node = rest.pop()\n    if (node && node.pop) {\n      for (length = node.length; length--; ) {\n        rest.push(node[length])\n      }\n    } else if (node != null && node !== true && node !== false) {\n      children.push(node)\n    }\n  }\n\n  return typeof name === \"function\"\n    ? name(attributes || {}, children)\n    : {\n        nodeName: name,\n        attributes: attributes || {},\n        children: children,\n        key: attributes && attributes.key\n      }\n}\n\nexport function app(state, actions, view, container) {\n  var map = [].map\n  var rootElement = (container && container.children[0]) || null\n  var oldNode = rootElement && recycleElement(rootElement)\n  var lifecycle = []\n  var skipRender\n  var isRecycling = true\n  var globalState = clone(state)\n  var wiredActions = wireStateToActions([], globalState, clone(actions))\n\n  scheduleRender()\n\n  return wiredActions\n\n  function recycleElement(element) {\n    return {\n      nodeName: element.nodeName.toLowerCase(),\n      attributes: {},\n      children: map.call(element.childNodes, function(element) {\n        return element.nodeType === 3 // Node.TEXT_NODE\n          ? element.nodeValue\n          : recycleElement(element)\n      })\n    }\n  }\n\n  function resolveNode(node) {\n    return typeof node === \"function\"\n      ? resolveNode(node(globalState, wiredActions))\n      : node != null ? node : \"\"\n  }\n\n  function render() {\n    skipRender = !skipRender\n\n    var node = resolveNode(view)\n\n    if (container && !skipRender) {\n      rootElement = patch(container, rootElement, oldNode, (oldNode = node))\n    }\n\n    isRecycling = false\n\n    while (lifecycle.length) lifecycle.pop()()\n  }\n\n  function scheduleRender() {\n    if (!skipRender) {\n      skipRender = true\n      setTimeout(render)\n    }\n  }\n\n  function clone(target, source) {\n    var out = {}\n\n    for (var i in target) out[i] = target[i]\n    for (var i in source) out[i] = source[i]\n\n    return out\n  }\n\n  function set(path, value, source) {\n    var target = {}\n    if (path.length) {\n      target[path[0]] =\n        path.length > 1 ? set(path.slice(1), value, source[path[0]]) : value\n      return clone(source, target)\n    }\n    return value\n  }\n\n  function get(path, source) {\n    var i = 0\n    while (i < path.length) {\n      source = source[path[i++]]\n    }\n    return source\n  }\n\n  function wireStateToActions(path, state, actions) {\n    for (var key in actions) {\n      typeof actions[key] === \"function\"\n        ? (function(key, action) {\n            actions[key] = function(data) {\n              var result = action(data)\n\n              if (typeof result === \"function\") {\n                result = result(get(path, globalState), actions)\n              }\n\n              if (\n                result &&\n                result !== (state = get(path, globalState)) &&\n                !result.then // !isPromise\n              ) {\n                scheduleRender(\n                  (globalState = set(path, clone(state, result), globalState))\n                )\n              }\n\n              return result\n            }\n          })(key, actions[key])\n        : wireStateToActions(\n            path.concat(key),\n            (state[key] = clone(state[key])),\n            (actions[key] = clone(actions[key]))\n          )\n    }\n\n    return actions\n  }\n\n  function getKey(node) {\n    return node ? node.key : null\n  }\n\n  function eventListener(event) {\n    return event.currentTarget.events[event.type](event)\n  }\n\n  function updateAttribute(element, name, value, oldValue, isSvg) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in clone(oldValue, value)) {\n        var style = value == null || value[i] == null ? \"\" : value[i]\n        if (i[0] === \"-\") {\n          element[name].setProperty(i, style)\n        } else {\n          element[name][i] = style\n        }\n      }\n    } else {\n      if (name[0] === \"o\" && name[1] === \"n\") {\n        name = name.slice(2)\n\n        if (element.events) {\n          if (!oldValue) oldValue = element.events[name]\n        } else {\n          element.events = {}\n        }\n\n        element.events[name] = value\n\n        if (value) {\n          if (!oldValue) {\n            element.addEventListener(name, eventListener)\n          }\n        } else {\n          element.removeEventListener(name, eventListener)\n        }\n      } else if (name in element && name !== \"list\" && !isSvg) {\n        element[name] = value == null ? \"\" : value\n      } else if (value != null && value !== false) {\n        element.setAttribute(name, value)\n      }\n\n      if (value == null || value === false) {\n        element.removeAttribute(name)\n      }\n    }\n  }\n\n  function createElement(node, isSvg) {\n    var element =\n      typeof node === \"string\" || typeof node === \"number\"\n        ? document.createTextNode(node)\n        : (isSvg = isSvg || node.nodeName === \"svg\")\n          ? document.createElementNS(\n              \"http://www.w3.org/2000/svg\",\n              node.nodeName\n            )\n          : document.createElement(node.nodeName)\n\n    var attributes = node.attributes\n    if (attributes) {\n      if (attributes.oncreate) {\n        lifecycle.push(function() {\n          attributes.oncreate(element)\n        })\n      }\n\n      for (var i = 0; i < node.children.length; i++) {\n        element.appendChild(\n          createElement(\n            (node.children[i] = resolveNode(node.children[i])),\n            isSvg\n          )\n        )\n      }\n\n      for (var name in attributes) {\n        updateAttribute(element, name, attributes[name], null, isSvg)\n      }\n    }\n\n    return element\n  }\n\n  function updateElement(element, oldAttributes, attributes, isSvg) {\n    for (var name in clone(oldAttributes, attributes)) {\n      if (\n        attributes[name] !==\n        (name === \"value\" || name === \"checked\"\n          ? element[name]\n          : oldAttributes[name])\n      ) {\n        updateAttribute(\n          element,\n          name,\n          attributes[name],\n          oldAttributes[name],\n          isSvg\n        )\n      }\n    }\n\n    var cb = isRecycling ? attributes.oncreate : attributes.onupdate\n    if (cb) {\n      lifecycle.push(function() {\n        cb(element, oldAttributes)\n      })\n    }\n  }\n\n  function removeChildren(element, node) {\n    var attributes = node.attributes\n    if (attributes) {\n      for (var i = 0; i < node.children.length; i++) {\n        removeChildren(element.childNodes[i], node.children[i])\n      }\n\n      if (attributes.ondestroy) {\n        attributes.ondestroy(element)\n      }\n    }\n    return element\n  }\n\n  function removeElement(parent, element, node) {\n    function done() {\n      parent.removeChild(removeChildren(element, node))\n    }\n\n    var cb = node.attributes && node.attributes.onremove\n    if (cb) {\n      cb(element, done)\n    } else {\n      done()\n    }\n  }\n\n  function patch(parent, element, oldNode, node, isSvg) {\n    if (node === oldNode) {\n    } else if (oldNode == null || oldNode.nodeName !== node.nodeName) {\n      var newElement = createElement(node, isSvg)\n      parent.insertBefore(newElement, element)\n\n      if (oldNode != null) {\n        removeElement(parent, element, oldNode)\n      }\n\n      element = newElement\n    } else if (oldNode.nodeName == null) {\n      element.nodeValue = node\n    } else {\n      updateElement(\n        element,\n        oldNode.attributes,\n        node.attributes,\n        (isSvg = isSvg || node.nodeName === \"svg\")\n      )\n\n      var oldKeyed = {}\n      var newKeyed = {}\n      var oldElements = []\n      var oldChildren = oldNode.children\n      var children = node.children\n\n      for (var i = 0; i < oldChildren.length; i++) {\n        oldElements[i] = element.childNodes[i]\n\n        var oldKey = getKey(oldChildren[i])\n        if (oldKey != null) {\n          oldKeyed[oldKey] = [oldElements[i], oldChildren[i]]\n        }\n      }\n\n      var i = 0\n      var k = 0\n\n      while (k < children.length) {\n        var oldKey = getKey(oldChildren[i])\n        var newKey = getKey((children[k] = resolveNode(children[k])))\n\n        if (newKeyed[oldKey]) {\n          i++\n          continue\n        }\n\n        if (newKey == null || isRecycling) {\n          if (oldKey == null) {\n            patch(element, oldElements[i], oldChildren[i], children[k], isSvg)\n            k++\n          }\n          i++\n        } else {\n          var keyedNode = oldKeyed[newKey] || []\n\n          if (oldKey === newKey) {\n            patch(element, keyedNode[0], keyedNode[1], children[k], isSvg)\n            i++\n          } else if (keyedNode[0]) {\n            patch(\n              element,\n              element.insertBefore(keyedNode[0], oldElements[i]),\n              keyedNode[1],\n              children[k],\n              isSvg\n            )\n          } else {\n            patch(element, oldElements[i], null, children[k], isSvg)\n          }\n\n          newKeyed[newKey] = children[k]\n          k++\n        }\n      }\n\n      while (i < oldChildren.length) {\n        if (getKey(oldChildren[i]) == null) {\n          removeElement(element, oldElements[i], oldChildren[i])\n        }\n        i++\n      }\n\n      for (var i in oldKeyed) {\n        if (!newKeyed[i]) {\n          removeElement(element, oldKeyed[i][0], oldKeyed[i][1])\n        }\n      }\n    }\n    return element\n  }\n}\n","import { h } from \"hyperapp\";\r\n\r\nexport const TreeNode = ({ config, callAction }, children) => {\r\n  const clickHandler = event => {\r\n    if (config.childrenIds.length !== 0)\r\n      callAction(\"toggleExpandCollapse\", config.id);\r\n    event.stopPropagation();\r\n  };\r\n\r\n  const style = {\r\n    marginLeft: \"10px\",\r\n    display: config.isExpand ? \"block\" : \"none\"\r\n  };\r\n\r\n  const renderHeader = () => {\r\n    if (config.childrenIds.length === 0) return <h4>{config.text}</h4>;\r\n    if (config.isExpand) return <h4>↑ {config.text}</h4>;\r\n    return <h4>↓ {config.text}</h4>;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      oncreate={() => console.log(\"Node created!\")}\r\n      onupdate={() => console.log(\"Node updated!\")}\r\n      onremove={() => console.log(\"Node removed!\")}\r\n      onclick={clickHandler}\r\n      name={config.id}\r\n      key={config.id}\r\n    >\r\n      {renderHeader()}\r\n      <div style={style}>{children}</div>\r\n    </div>\r\n  );\r\n};\r\n","export const actions = {\r\n  getState: () => state => {\r\n    return state;\r\n  },\r\n\r\n  subscribe: handler => state => {\r\n    return { ...state, subscribeHandler: handler };\r\n  },\r\n\r\n  changeTitle: title => state => {\r\n    return { ...state, title: title };\r\n  },\r\n\r\n  toggleExpandCollapse: id => (state, actions) => {\r\n    const node = state.nodes[id];\r\n    const isExpand = !node.isExpand;\r\n    return {\r\n      ...state,\r\n      nodes: {\r\n        ...state.nodes,\r\n        [id]: {\r\n          ...node,\r\n          isExpand\r\n        }\r\n      }\r\n    };\r\n  }\r\n};\r\n","import { h, app } from \"hyperapp\";\r\n\r\nimport { TreeNode } from \"./components/TreeNode.js\";\r\nimport { actions } from \"./actions.js\";\r\n\r\nexport const normalize = (nodes, nodesCount) => {\r\n  let id, node;\r\n  let stack = nodes;\r\n  let normalizedTree = {};\r\n\r\n  const addNodeToSiblings = (node, nodes) => {\r\n    nodes.forEach((siblingNode, siblingIndex) => {\r\n      if (!Array.isArray(siblingNode.siblingsIds)) siblingNode.siblingsIds = [];\r\n      if (siblingIndex === node.index - 1) return;\r\n      siblingNode.siblingsIds.push(node.id);\r\n    });\r\n  };\r\n\r\n  stack.forEach((node, index) => {\r\n    node.parentId = \"root\";\r\n    node.index = index + 1;\r\n    node.id = \"ht-node-\" + nodesCount++;\r\n    addNodeToSiblings(node, stack);\r\n  });\r\n\r\n  while (stack.length > 0) {\r\n    node = stack.shift();\r\n    id = node.id;\r\n\r\n    /* defaults */\r\n    if (typeof node.isExpand !== typeof true) node.isExpand = true;\r\n    /* EO defaults */\r\n\r\n    if (Array.isArray(node.children)) {\r\n      node.children.forEach((subnode, index) => {\r\n        subnode.parentId = id;\r\n        subnode.index = index + 1;\r\n        subnode.id = \"ht-node-\" + nodesCount++;\r\n\r\n        if (!Array.isArray(node.childrenIds)) node.childrenIds = [];\r\n        node.childrenIds.push(subnode.id);\r\n\r\n        addNodeToSiblings(subnode, node.children);\r\n\r\n        stack.push(subnode);\r\n      });\r\n\r\n      delete node.children;\r\n    } else {\r\n      node.childrenIds = [];\r\n    }\r\n\r\n    normalizedTree[id] = node;\r\n  }\r\n\r\n  return normalizedTree;\r\n};\r\n\r\nexport const generateMarkup = (normalizedTree, callAction) => {\r\n  let stack = [];\r\n  let markup = [];\r\n  let nodeMarkup, nodeConfig, childConfig, childMarkup;\r\n\r\n  for (let nodeId in normalizedTree) {\r\n    nodeConfig = normalizedTree[nodeId];\r\n    if (nodeConfig.parentId === \"root\") {\r\n      nodeMarkup = <TreeNode config={nodeConfig} callAction={callAction} />;\r\n      stack.push(nodeMarkup);\r\n      markup.push(nodeMarkup);\r\n    }\r\n  }\r\n\r\n  while (stack.length > 0) {\r\n    nodeMarkup = stack.shift();\r\n    nodeConfig = normalizedTree[nodeMarkup.attributes.key];\r\n\r\n    if (nodeConfig.childrenIds.length !== 0) {\r\n      nodeConfig.childrenIds.forEach(childId => {\r\n        childConfig = normalizedTree[childId];\r\n        childMarkup = <TreeNode config={childConfig} callAction={callAction} />;\r\n        nodeMarkup.children[1].children.push(childMarkup); //bad code\r\n\r\n        if (childConfig.childrenIds.length !== 0) stack.push(childMarkup);\r\n      });\r\n    }\r\n  }\r\n\r\n  return markup;\r\n};\r\n\r\nexport const callAction = (actionName, payload, actions) => {\r\n  if (!actions[actionName]) {\r\n    console.warn(\"you try to call wrong action!\");\r\n    return;\r\n  }\r\n\r\n  const newState = actions[actionName](payload);\r\n  newState.subscribeHandler({\r\n    actionName,\r\n    newState\r\n  });\r\n};\r\n\r\nexport const view = (state, actions) => {\r\n  const doCallAction = (actionName, payload) =>\r\n    callAction(actionName, payload, actions);\r\n  let markup = generateMarkup(state.nodes, doCallAction);\r\n\r\n  return (\r\n    <div>\r\n      <h1>{state.title}</h1>\r\n      {markup}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const render = config => {\r\n  const state = {\r\n    title: config.title,\r\n    actionHandlers: {},\r\n    subscribeHandler: () => {},\r\n    nodes: normalize(config.nodes, 1)\r\n  };\r\n\r\n  const wiredActions = app(state, actions, view, document.body);\r\n\r\n  return {\r\n    //doc: {actionName: \"description\"}, // TODO\r\n    getState: wiredActions.getState,\r\n    callAction: (actionName, payload) =>\r\n      callAction(actionName, payload, wiredActions),\r\n    subscribe: wiredActions.subscribe\r\n  };\r\n};\r\n"]}